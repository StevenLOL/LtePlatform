angular.module("app.core",[]).factory("appUrlService",function(){var e=function(e){var t,r,n,o,s,c,i={};if(null===e||void 0===e)return i;for(var a=e.split("?")[1].split("&"),u=0;u<a.length;u++)-1===(r=(t=a[u]).indexOf("="))?(n=t,o=null):(n=t.substr(0,r),o=t.substr(r+1)),s=decodeURIComponent(n),c=decodeURIComponent(o),i[s]=c;return i},t=function(){if(0===window.location.hash.indexOf("#")){var t=window.location.hash.replace("/","?");return e(t)}return{}},r=function(){if(!sessionStorage.getItem("accessToken")){var e=t();e.access_token?(window.location.hash=e.state||"",sessionStorage.setItem("accessToken",e.access_token)):window.location="/Account/Authorize?client_id=web&response_type=token&state="+encodeURIComponent(window.location.hash)}};return{getApiUrl:function(e){return"/api/"+e},userInfoUrl:"/api/Me",siteUrl:"/",parseQueryString:e,getAccessToken:function(){var e=sessionStorage.getItem("accessToken");return e||r(),e||sessionStorage.getItem("accessToken")},initializeAuthorization:r,getPlanUrlHost:function(){return"219.128.254.38"===window.location.hostname?"http://219.128.254.36:8070/":"http://10.17.165.111:8070/"},getDtUrlHost:function(){return"219.128.254.38"===window.location.hostname?"http://219.128.254.38:2888/":"http://10.17.165.100:2888/"},getDistributionHost:function(){return"219.128.254.38"===window.location.hostname?"http://219.128.254.36:8086/":"http://10.17.165.111:8086/"},getParameterUrlHost:function(){return"219.128.254.38"===window.location.hostname?"http://219.128.254.36:8001/":"http://10.17.165.111:8001/"},getBuildingUrlHost:function(){return"219.128.254.38"===window.location.hostname?"http://219.128.254.36:8002/":"http://10.17.165.111:8002/"},getTopnUrlHost:function(){return"219.128.254.38"===window.location.hostname?"http://219.128.254.36:8006/":"http://10.17.165.111:8006/"},getInterferenceHost:function(){return"219.128.254.38"===window.location.hostname?"http://219.128.254.36:8004/":"http://10.17.165.111:8004/"},getCustomerHost:function(){return"219.128.254.38"===window.location.hostname?"http://219.128.254.38:8099/":"http://10.17.165.100:8099/"},getPhpHost:function(){return"219.128.254.38"===window.location.hostname?"http://219.128.254.36:9000/":"http://10.17.165.111:9000/"},getPhpUriComponent:function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t.join("&")},initializeIndexedDb:function(e,t,r,n){var o=e.version||1,s=window.indexedDB.open(e.name,o);s.onerror=function(e){console.log(e.currentTarget.error.message)},s.onsuccess=function(t){e.db=t.target.result,n&&n()},s.onupgradeneeded=function(e){var n=e.target.result;angular.forEach(t,function(e){n.objectStoreNames.contains(e)||n.createObjectStore(e,{keyPath:r})}),console.log("DB version changed to "+o)}},updateIndexedDb:function(e,t,r,n,o){var s=e.transaction(t,"readwrite").objectStore(t),c=s.get(n);o[r]=n,c.onsuccess=function(e){e.target.result?s.put(o):s.add(o)}},refreshIndexedDb:function(e,t,r,n){var o=e.transaction(t,"readwrite").objectStore(t);o.clear(),angular.forEach(n,function(e){o.put(e)})},fetchStoreByCursor:function(e,t,r){var n=[];e.transaction(t).objectStore(t).openCursor().onsuccess=function(e){var t=e.target.result;t?(n.push(t.value),t.continue()):r&&r(n)}}}}).controller("header.menu",function(e,t){e.interferenceUrl=t.getInterferenceHost(),e.emergencyUrl=t.getCustomerHost()+"IndexOfEmerCom.aspx",e.repeaterUrl=t.getCustomerHost()+"IndexOfMicro.aspx",e.marketUrl=t.getCustomerHost()+"IndexOfTelJobs.aspx",e.rfUrl=t.getParameterUrlHost()+"RadioFreqency.html",e.commonMenu={$folded:!0}}).factory("generalHttpService",function(e,t,r){return{getMvcData:function(r,n){var o=e.defer();return t({method:"GET",url:r,params:n}).success(function(e){o.resolve(e)}).error(function(e){o.reject(e)}),o.promise},getApiData:function(n,o){var s=e.defer();return t({method:"GET",url:r.getApiUrl(n),params:o}).success(function(e){s.resolve(e)}).error(function(e){s.reject(e)}),s.promise},getApiDataWithHeading:function(n,o){var s=e.defer();return t({method:"GET",url:r.getApiUrl(n),params:o,headers:{Authorization:"Bearer "+r.getAccessToken()}}).success(function(e){s.resolve(e)}).error(function(e){s.reject(e)}),s.promise},postApiData:function(n,o){var s=e.defer();return t.post(r.getApiUrl(n),o).success(function(e){s.resolve(e)}).error(function(e){s.reject(e)}),s.promise},postMvcData:function(r,n){var o=e.defer();return t.post(r,n).success(function(e){o.resolve(e)}).error(function(e){o.reject(e)}),o.promise},postApiDataWithHeading:function(n,o){var s=e.defer();return t({method:"POST",url:r.getApiUrl(n),data:o,headers:{Authorization:"Bearer "+r.getAccessToken()}}).success(function(e){s.resolve(e)}).error(function(e){s.reject(e)}),s.promise},postPhpUrlData:function(n,o){var s=e.defer();return t({method:"POST",url:n,data:o,headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:function(e){return r.getPhpUriComponent(e)}}).success(function(e){s.resolve(e)}).error(function(e){s.reject(e)}),s.promise},putApiData:function(n,o){var s=e.defer();return t.put(r.getApiUrl(n),o).success(function(e){s.resolve(e)}).error(function(e){s.reject(e)}),s.promise},deleteApiData:function(n){var o=e.defer();return t.delete(r.getApiUrl(n)).success(function(e){o.resolve(e)}).error(function(e){o.reject(e)}),o.promise},getJsonpData:function(r,n){var o=e.defer();return t.jsonp(r).success(function(e){o.resolve(n(e))}).error(function(e){o.reject(e)}),o.promise},getUrlData:function(r,n){var o=e.defer();return t({method:"GET",url:r,params:n}).success(function(e){o.resolve(e)}).error(function(e){o.reject(e)}),o.promise}}});