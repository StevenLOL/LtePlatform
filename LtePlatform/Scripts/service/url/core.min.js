angular.module("app.core",[]).factory("appUrlService",function(){var t=function(t){var e,n,o,r,a,c,i={};if(null===t||void 0===t)return i;for(var s=t.split("?")[1].split("&"),u=0;u<s.length;u++)-1===(n=(e=s[u]).indexOf("="))?(o=e,r=null):(o=e.substr(0,n),r=e.substr(n+1)),a=decodeURIComponent(o),c=decodeURIComponent(r),i[a]=c;return i},e=function(){if(0===window.location.hash.indexOf("#")){var e=window.location.hash.replace("/","?");return t(e)}return{}},n=function(){if(!sessionStorage.getItem("accessToken")){var t=e();t.access_token?(window.location.hash=t.state||"",sessionStorage.setItem("accessToken",t.access_token)):window.location="/Account/Authorize?client_id=web&response_type=token&state="+encodeURIComponent(window.location.hash)}};return{getApiUrl:function(t){return"/api/"+t},userInfoUrl:"/api/Me",siteUrl:"/",parseQueryString:t,getAccessToken:function(){var t=sessionStorage.getItem("accessToken");return t||n(),t||sessionStorage.getItem("accessToken")},initializeAuthorization:n,getPlanUrlHost:function(){return"119.145.142.74"===window.location.hostname?"http://119.145.142.74:8108/":"http://132.110.71.122:8070/"},getDtUrlHost:function(){return"119.145.142.74"===window.location.hostname?"http://119.145.142.74:8101/":"http://132.110.71.121:2888/"},getDistributionHost:function(){return"119.145.142.74"===window.location.hostname?"http://119.145.142.74:8109/":"http://132.110.71.122:8086/"},getParameterUrlHost:function(){return"119.145.142.74"===window.location.hostname?"http://119.145.142.74:8110/":"http://132.110.71.122:8001/"},getBuildingUrlHost:function(){return"119.145.142.74"===window.location.hostname?"http://119.145.142.74:8111/":"http://132.110.71.122:8002/"},getTopnUrlHost:function(){return"119.145.142.74"===window.location.hostname?"http://119.145.142.74:8112/":"http://132.110.71.122:8006/"},getInterferenceHost:function(){return"119.145.142.74"===window.location.hostname?"http://119.145.142.74:8113/":"http://132.110.71.122:18080/"},getCustomerHost:function(){return"119.145.142.74"===window.location.hostname?"http://119.145.142.74:8102/":"http://132.110.71.121:8018/"},getPhpHost:function(){return"119.145.142.74"===window.location.hostname?"http://119.145.142.74:8106/":"http://132.110.71.122:9000/"},getPhpUriComponent:function(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e.join("&")},initializeIndexedDb:function(t,e,n,o){var r=t.version||1,a=window.indexedDB.open(t.name,r);a.onerror=function(t){console.log(t.currentTarget.error.message)},a.onsuccess=function(e){t.db=e.target.result,o&&o()},a.onupgradeneeded=function(t){var o=t.target.result;angular.forEach(e,function(t){o.objectStoreNames.contains(t)||o.createObjectStore(t,{keyPath:n})}),console.log("DB version changed to "+r)}},updateIndexedDb:function(t,e,n,o,r){var a=t.transaction(e,"readwrite").objectStore(e),c=a.get(o);r[n]=o,c.onsuccess=function(t){t.target.result?a.put(r):a.add(r)}},refreshIndexedDb:function(t,e,n,o){var r=t.transaction(e,"readwrite").objectStore(e);r.clear(),angular.forEach(o,function(t){r.put(t)})},fetchStoreByCursor:function(t,e,n){var o=[];t.transaction(e).objectStore(e).openCursor().onsuccess=function(t){var e=t.target.result;e?(o.push(e.value),e.continue()):n&&n(o)}}}}).controller("header.menu",function(t,e){t.emergencyUrl=e.getCustomerHost()+"IndexOfEmerCom.aspx",t.marketUrl=e.getCustomerHost()+"IndexOfTelJobs.aspx",t.rfUrl=e.getParameterUrlHost()+"RadioFreqency.html",t.commonMenu={$folded:!0}}).factory("generalHttpService",function(t,e,n,o){return{getMvcData:function(n,o){var r=t.defer();return e({method:"GET",url:n,params:o}).then(function(t){r.resolve(t.data)}).catch(function(t){r.reject(t)}),r.promise},getApiData:function(n,r){var a=t.defer();return e({method:"GET",url:o.getApiUrl(n),params:r}).then(function(t){a.resolve(t.data)}).catch(function(t){a.reject(t)}),a.promise},getApiDataWithHeading:function(n,r){var a=t.defer();return e({method:"GET",url:o.getApiUrl(n),params:r,headers:{Authorization:"Bearer "+o.getAccessToken()}}).then(function(t){a.resolve(t.data)}).catch(function(t){a.reject(t)}),a.promise},postApiData:function(n,r){var a=t.defer();return e.post(o.getApiUrl(n),r).then(function(t){a.resolve(t.data)}).catch(function(t){a.reject(t)}),a.promise},postMvcData:function(n,o){var r=t.defer();return e.post(n,o).then(function(t){r.resolve(t.data)}).catch(function(t){r.reject(t)}),r.promise},postApiDataWithHeading:function(n,r){var a=t.defer();return e({method:"POST",url:o.getApiUrl(n),data:r,headers:{Authorization:"Bearer "+o.getAccessToken()}}).then(function(t){a.resolve(t.data)}).catch(function(t){a.reject(t)}),a.promise},postPhpUrlData:function(n,r){var a=t.defer();return e({method:"POST",url:n,data:r,headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:function(t){return o.getPhpUriComponent(t)}}).then(function(t){a.resolve(t.data)}).catch(function(t){a.reject(t)}),a.promise},putApiData:function(n,r){var a=t.defer();return e.put(o.getApiUrl(n),r).then(function(t){a.resolve(t.data)}).catch(function(t){a.reject(t)}),a.promise},deleteApiData:function(n){var r=t.defer();return e.delete(o.getApiUrl(n)).then(function(t){r.resolve(t.data)}).catch(function(t){r.reject(t)}),r.promise},getJsonpData:function(n,o){var r=t.defer();return e.jsonp(n,{jsonpCallbackParam:"callback"}).then(function(t){r.resolve(o(t.data))}).catch(function(t){r.reject(t)}),r.promise},getUrlData:function(n,o){var r=t.defer();return e({method:"GET",url:n,params:o}).then(function(t){r.resolve(t.data)}).catch(function(t){r.reject(t)}),r.promise}}});