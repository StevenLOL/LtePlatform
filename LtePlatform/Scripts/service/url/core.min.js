angular.module("app.core",[]).factory("appUrlService",function(){var e=function(e){var t,n,r,o,s,i,c={};if(null===e||void 0===e)return c;for(var a=e.split("?")[1].split("&"),u=0;u<a.length;u++)-1===(n=(t=a[u]).indexOf("="))?(r=t,o=null):(r=t.substr(0,n),o=t.substr(n+1)),s=decodeURIComponent(r),i=decodeURIComponent(o),c[s]=i;return c},t=function(){if(0===window.location.hash.indexOf("#")){var t=window.location.hash.replace("/","?");return e(t)}return{}},n=function(){if(!sessionStorage.getItem("accessToken")){var e=t();e.access_token?(window.location.hash=e.state||"",sessionStorage.setItem("accessToken",e.access_token)):window.location="/Account/Authorize?client_id=web&response_type=token&state="+encodeURIComponent(window.location.hash)}};return{getApiUrl:function(e){return"/api/"+e},userInfoUrl:"/api/Me",siteUrl:"/",parseQueryString:e,getAccessToken:function(){var e=sessionStorage.getItem("accessToken");return e||n(),e||sessionStorage.getItem("accessToken")},initializeAuthorization:n,getPlanUrlHost:function(){return"119.145.142.74"===window.location.hostname?"http://119.145.142.74:8108/":"http://132.110.71.122:8070/"},getDtUrlHost:function(){return"119.145.142.74"===window.location.hostname?"http://119.145.142.74:8101/":"http://132.110.71.121:2888/"},getDistributionHost:function(){return"119.145.142.74"===window.location.hostname?"http://119.145.142.74:8109/":"http://132.110.71.122:8086/"},getParameterUrlHost:function(){return"119.145.142.74"===window.location.hostname?"http://119.145.142.74:8110/":"http://132.110.71.122:8001/"},getBuildingUrlHost:function(){return"119.145.142.74"===window.location.hostname?"http://119.145.142.74:8111/":"http://132.110.71.122:8002/"},getTopnUrlHost:function(){return"119.145.142.74"===window.location.hostname?"http://119.145.142.74:8112/":"http://132.110.71.122:8006/"},getInterferenceHost:function(){return"119.145.142.74"===window.location.hostname?"http://119.145.142.74:8113/":"http://132.110.71.122:18080/"},getCustomerHost:function(){return"119.145.142.74"===window.location.hostname?"http://119.145.142.74:8102/":"http://132.110.71.121:8018/"},getPhpHost:function(){return"119.145.142.74"===window.location.hostname?"http://119.145.142.74:8106/":"http://132.110.71.122:9000/"},getPhpUriComponent:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")},initializeIndexedDb:function(e,t,n,r){var o=e.version||1,s=window.indexedDB.open(e.name,o);s.onerror=function(e){console.log(e.currentTarget.error.message)},s.onsuccess=function(t){e.db=t.target.result,r&&r()},s.onupgradeneeded=function(e){var r=e.target.result;angular.forEach(t,function(e){r.objectStoreNames.contains(e)||r.createObjectStore(e,{keyPath:n})}),console.log("DB version changed to "+o)}},updateIndexedDb:function(e,t,n,r,o){var s=e.transaction(t,"readwrite").objectStore(t),i=s.get(r);o[n]=r,i.onsuccess=function(e){e.target.result?s.put(o):s.add(o)}},refreshIndexedDb:function(e,t,n,r){var o=e.transaction(t,"readwrite").objectStore(t);o.clear(),angular.forEach(r,function(e){o.put(e)})},fetchStoreByCursor:function(e,t,n){var r=[];e.transaction(t).objectStore(t).openCursor().onsuccess=function(e){var t=e.target.result;t?(r.push(t.value),t.continue()):n&&n(r)}}}}).controller("header.menu",function(e,t){e.emergencyUrl=t.getCustomerHost()+"IndexOfEmerCom.aspx",e.marketUrl=t.getCustomerHost()+"IndexOfTelJobs.aspx",e.rfUrl=t.getParameterUrlHost()+"RadioFreqency.html",e.commonMenu={$folded:!0}}).factory("generalHttpService",function(e,t,n){return{getMvcData:function(n,r){var o=e.defer();return t({method:"GET",url:n,params:r}).success(function(e){o.resolve(e)}).error(function(e){o.reject(e)}),o.promise},getApiData:function(r,o){var s=e.defer();return t({method:"GET",url:n.getApiUrl(r),params:o}).success(function(e){s.resolve(e)}).error(function(e){s.reject(e)}),s.promise},getApiDataWithHeading:function(r,o){var s=e.defer();return t({method:"GET",url:n.getApiUrl(r),params:o,headers:{Authorization:"Bearer "+n.getAccessToken()}}).success(function(e){s.resolve(e)}).error(function(e){s.reject(e)}),s.promise},postApiData:function(r,o){var s=e.defer();return t.post(n.getApiUrl(r),o).success(function(e){s.resolve(e)}).error(function(e){s.reject(e)}),s.promise},postMvcData:function(n,r){var o=e.defer();return t.post(n,r).success(function(e){o.resolve(e)}).error(function(e){o.reject(e)}),o.promise},postApiDataWithHeading:function(r,o){var s=e.defer();return t({method:"POST",url:n.getApiUrl(r),data:o,headers:{Authorization:"Bearer "+n.getAccessToken()}}).success(function(e){s.resolve(e)}).error(function(e){s.reject(e)}),s.promise},postPhpUrlData:function(r,o){var s=e.defer();return t({method:"POST",url:r,data:o,headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:function(e){return n.getPhpUriComponent(e)}}).success(function(e){s.resolve(e)}).error(function(e){s.reject(e)}),s.promise},putApiData:function(r,o){var s=e.defer();return t.put(n.getApiUrl(r),o).success(function(e){s.resolve(e)}).error(function(e){s.reject(e)}),s.promise},deleteApiData:function(r){var o=e.defer();return t.delete(n.getApiUrl(r)).success(function(e){o.resolve(e)}).error(function(e){o.reject(e)}),o.promise},getJsonpData:function(n,r){var o=e.defer();return t.jsonp(n).success(function(e){o.resolve(r(e))}).error(function(e){o.reject(e)}),o.promise},getUrlData:function(n,r){var o=e.defer();return t({method:"GET",url:n,params:r}).success(function(e){o.resolve(e)}).error(function(e){o.reject(e)}),o.promise}}});